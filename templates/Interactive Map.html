{% extends 'base.html' %}

{% block title %}EcoTrack Map Page{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/FP.css') }}" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.icon.glyph/Leaflet.Icon.Glyph.js"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/map.css') }}" />
{% endblock %}
<!-- Map page head: loads map libraries, fonts and page styles -->

{% block content %}
<body class="selection:bg-yellow-100 selection:text-gray-900">
    <div id="map-view-app">
      <!-- Interactive map application container: map controls, filters and legend live here -->
      {% from '_header.html' import render_header %}
{{ render_header(page_title='EcoTrack Batangas Map', right_html='<a href="' ~ url_for('pages.index') ~ '" class="px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-lg text-sm transition duration-150">← Back to MainPage</a>') }}

      <main class="p-6 md:p-10 max-w-7xl mx-auto">
        <!-- Main map area: title, filters and the map container where Leaflet will render tiles -->
        <h2 class="text-2xl md:text-3xl font-bold mb-4 text-gray-800">
          Interactive Map view
        </h2>

        <div class="flex items-center space-x-3 mb-6">
          <label for="severity-filter" class="text-gray-700 font-medium"
            >Filter Severity:</label
          >
          <select
            id="severity-filter"
            class="severity-filter appearance-none border border-gray-700 px-4 py-2 text-sm cursor-pointer focus:ring-2 focus:ring-red-500 focus:border-red-500 transition duration-150"
          >
            <option value="All">All Municipalities</option>
            <option value="Critical">Critical</option>
            <option value="High">High</option>
            <option value="Medium">Medium</option>
            <option value="Low">Low</option>
          </select>
        </div>

        <div
          id="map-container"
          class="map-container relative overflow-hidden p-0 flex items-center justify-center"
        ></div>
        <!-- `#map-container` is the target element for the Leaflet map instance created by `js/map.js` -->

        <div
          class="flex flex-wrap justify-center space-x-6 mt-8 p-4 bg-white rounded-xl shadow-md"
        >
          <div class="flex items-center text-sm text-gray-700">
            <span
              class="severity-indicator"
              style="background-color: var(--color-critical-red)"
            ></span>
            Critical
          </div>
          <div class="flex items-center text-sm text-gray-700">
            <span
              class="severity-indicator"
              style="background-color: var(--color-high-orange)"
            ></span>
            High
          </div>
          <div class="flex items-center text-sm text-gray-700">
            <span
              class="severity-indicator"
              style="background-color: var(--color-medium-yellow)"
            ></span>
            Medium
          </div>
          <div class="flex items-center text-sm text-gray-700">
            <span
              class="severity-indicator"
              style="background-color: var(--color-low-cyan)"
            ></span>
            Low
          </div>
        </div>
      </main>
    </div>

    <div
      id="dashboard-view-app"
      class="dashboard-view max-w-4xl mx-auto my-12 hidden"
    >
      <!-- Optional dashboard panel for detailed city reports; toggled via JS when user wants deeper analysis -->
      <svg
        class="mx-auto h-16 w-16 text-green-500"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
        ></path>
      </svg>
      <h2 class="text-3xl font-bold text-gray-800 mt-4">Dashboard Page</h2>
      <p class="text-gray-600 mt-2 mb-6">
        You have successfully navigated to the detailed dashboard for
        <span id="dashboard-city-name" class="font-bold"></span>. This is where
        comprehensive data visualizations and deeper analysis would appear.
      </p>
      <button
        id="go-back-btn"
        class="bg-green-400 hover:bg-green-500 text-blue font-semibold py-2 px-6 rounded-lg transition duration-200"
      >
        ← Back to Map View
      </button>
    </div>

    <script src="{{ url_for('static', filename='js/map.js') }}"></script>
{% endblock %}
