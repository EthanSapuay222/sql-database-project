{% extends "base.html" %}

{% block title %}EcoTrack - Admin Dashboard{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
{% endblock %}

{% block content %}
<div class="admin-container">
    <header class="admin-header">
        <h1>EcoTrack Admin - Reports Management</h1>
        <div class="header-right">
            <span>Welcome, {{ session.get('username', 'Admin') }}</span>
            <a href="{{ url_for('auth.logout') }}" class="logout-btn">Logout</a>
        </div>
    </header>

    <main class="admin-main">
        <h2>EcoTrack Admin Dashboard</h2>
        <p>Manage environmental reports, animal sightings, and users</p>

        <!-- Tab Navigation -->
        <div class="admin-tabs">
            <button class="tab-button active" onclick="switchTab('reports')">Environmental Reports</button>
            <button class="tab-button" onclick="switchTab('sightings')">Animal Sightings</button>
            <button class="tab-button" onclick="switchTab('users')">Users</button>
        </div>

        <!-- Environmental Reports Section -->
        <section id="reports-tab" class="tab-content active">
            <h2>Environmental Reports Management</h2>

            <div class="summary">
                <div class="summary-card">
                    <h3>Total Reports</h3>
                    <p class="summary-number" id="total-reports">0</p>
                </div>
                <div class="summary-card">
                    <h3>Pending Review</h3>
                    <p class="summary-number" id="pending-reports">0</p>
                </div>
                <div class="summary-card">
                    <h3>Approved</h3>
                    <p class="summary-number" id="approved-reports">0</p>
                </div>
            </div>

            <section class="reports-section">
                <h3>User Reports</h3>
                <table class="reports-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Title</th>
                            <th>Type</th>
                            <th>Severity</th>
                            <th>Status</th>
                            <th>Reporter</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="reports-tbody">
                        <tr>
                            <td colspan="7" style="text-align: center;">No reports submitted yet</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <div class="save-container">
                <button id="save-btn" class="save-button" onclick="saveAllChanges()">Save All Changes</button>
            </div>
        </section>

        <!-- Animal Sightings Section -->
        <section id="sightings-tab" class="tab-content hidden">
            <h2>Animal Sightings Management</h2>

            <div class="summary">
                <div class="summary-card">
                    <h3>Total Sightings</h3>
                    <p class="summary-number" id="total-sightings">0</p>
                </div>
                <div class="summary-card">
                    <h3>Pending Verification</h3>
                    <p class="summary-number" id="pending-sightings">0</p>
                </div>
                <div class="summary-card">
                    <h3>Verified</h3>
                    <p class="summary-number" id="verified-sightings">0</p>
                </div>
            </div>

            <section class="sightings-section">
                <h3>Animal Sightings</h3>
                <table class="sightings-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Species</th>
                            <th>Location</th>
                            <th>Observer</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="sightings-tbody">
                        <tr>
                            <td colspan="7" style="text-align: center;">No sightings submitted yet</td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </section>

        <!-- Users Section -->
        <section id="users-tab" class="tab-content hidden">
            <h2>User Management</h2>

            <div class="summary">
                <div class="summary-card">
                    <h3>Total Users</h3>
                    <p class="summary-number" id="total-users">0</p>
                </div>
            </div>

            <section class="users-section">
                <h3>Users</h3>
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Created</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="users-tbody">
                        <tr>
                            <td colspan="6" style="text-align: center;">No users found</td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </section>
    </main>

    <!-- Report Detail Modal -->
    <div id="report-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Report Details</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p><strong>ID:</strong> <span id="modal-id"></span></p>
                <p><strong>Title:</strong> <span id="modal-title"></span></p>
                <p><strong>Description:</strong> <span id="modal-description"></span></p>
                <p><strong>Type:</strong> <span id="modal-type"></span></p>
                <p><strong>Severity:</strong> <span id="modal-severity"></span></p>
                <p><strong>Reporter Name:</strong> <span id="modal-reporter-name"></span></p>
                <p><strong>Reporter Contact:</strong> <span id="modal-reporter-contact"></span></p>
                <p><strong>Status:</strong> <span id="modal-status" class="status-badge"></span></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="confirmStatusChange()">Confirm Change</button>
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}
